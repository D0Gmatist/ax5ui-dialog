!function(t,i){var e=ax5.util,n=function(){this.main=function(){i&&i.call(this),this.config={click_event_name:"click",theme:"default",width:300,title:"",msg:"",lang:{ok:"ok",cancel:"cancel"}}}.apply(this,arguments),this.active_dialog=null;var t=this.config;this.init=function(){t.id="ax5-dialog-"+ax5.getGuid()},this.alert=function(i,n){return e.is_string(i)&&(i={title:t.title,msg:i}),i.dialog_type="alert",i.theme=i.theme||t.theme||"","undefined"==typeof i.btns&&(i.btns={ok:{label:t.lang.ok,theme:i.theme}}),this.open(i,n),this},this.confirm=function(i,n){return e.is_string(i)&&(i={title:t.title,msg:i}),i.dialog_type="confirm",i.theme=i.theme||t.theme||"","undefined"==typeof i.btns&&(i.btns={ok:{label:t.lang.ok,theme:i.theme},cancel:{label:t.lang.cancel}}),this.open(i,n),this},this.prompt=function(i,n){return e.is_string(i)&&(i={title:t.title,msg:i}),i.dialog_type="prompt",i.theme=i.theme||t.theme||"","undefined"==typeof i.input&&(i.input={value:{label:i.msg||t.msg||""}}),"undefined"==typeof i.btns&&(i.btns={ok:{label:t.lang.ok,theme:i.theme},cancel:{label:t.lang.cancel}}),this.open(i,n),this},this.get_content=function(i,n){var a=[];return a.push('<div id="'+i+'" data-ax5-ui="dialog" class="ax5-ui-dialog '+n.theme+'">'),a.push('<div class="ax-dialog-heading">'),a.push(n.title||t.title||""),a.push("</div>"),a.push('<div class="ax-dialog-body">'),a.push('<div class="ax-dialog-msg">'),a.push((n.msg||t.msg||"").replace(/\n/g,"<br/>")),n.input&&e.each(n.input,function(t,i){a.push('<div class="ax-dialog-prompt">'),a.push(this.label.replace(/\n/g,"<br/>")),a.push("</div>"),a.push('<input type="'+(this.type||"text")+'" placeholder="'+(this.placeholder||"")+' " class="ax-inp '+(this.klass||"")+'" data-ax-dialog-prompt="'+t+'" style="width:100%;" value="'+(this.value||"")+'" />')}),a.push("</div>"),a.push('<div class="ax-dialog-buttons">'),a.push('<div class="ax-button-wrap">'),e.each(n.btns,function(t,i){a.push('<button type="button" data-ax-dialog-btn="'+t+'" class="ax-btn '+this.theme+'">'+this.label+"</button>")}),a.push("</div>"),a.push("</div>"),a.push("</div>"),a.push("</div>"),a.join("")},this.open=function(i,e){var n={},a={};if(i.id=i.id||t.id,a={width:i.width||t.width},axd.append(document.body,this.get_content(i.id,i)),this.active_dialog=ax5.dom("#"+i.id),this.active_dialog.css({width:a.width}),a.height=this.active_dialog.height(),"undefined"==typeof i.position||"center"===i.position){var o=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,l=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;n.top=l/2-a.height/2,n.left=o/2-a.width/2}else n.left=i.position.left||0,n.top=i.position.top||0;return this.active_dialog.css(n),"prompt"===i.dialog_type?this.active_dialog.find("[data-ax-dialog-prompt]").elements[0].focus():this.active_dialog.find("[data-ax-dialog-btn]").elements[0].focus(),this.active_dialog.find("[data-ax-dialog-btn]").on(t.click_event_name,function(t){this.btn_onclick(t||window.event,i,e)}.bind(this)),axd(window).on("keydown.ax-dialog",function(t){this.onkeyup(t||window.event,i,e)}.bind(this)),t.onopen&&t.onopen.call(this,this),this},this.btn_onclick=function(t,i,e,n,a){if(t.srcElement&&(t.target=t.srcElement),n=axd.parent(t.target,function(t){return ax5.dom.attr(t,"data-ax-dialog-btn")?!0:void 0})){a=axd.attr(n,"data-ax-dialog-btn");var o={key:a,value:i.btns[a],dialog_id:i.id,btn_target:n};if("prompt"===i.dialog_type){var l=null;for(var s in i.input)if(o[s]=this.active_dialog.find("[data-ax-dialog-prompt="+s+"]").val(),""==o[s]||null==o[s]){l=s;break}}if(i.btns[a].onclick)i.btns[a].onclick.call(o,a);else if("alert"===i.dialog_type)e&&e.call(o,a),this.close();else if("confirm"===i.dialog_type)e&&e.call(o,a),this.close();else if("prompt"===i.dialog_type){if("ok"===a&&l)return this.active_dialog.find('[data-ax-dialog-prompt="'+l+'"]').elements[0].focus(),!1;e&&e.call(o,a),this.close()}}},this.onkeyup=function(t,i,e,n,a){if(t.keyCode==ax5.info.event_keys.ESC&&this.close(),"prompt"===i.dialog_type&&t.keyCode==ax5.info.event_keys.RETURN){var o={key:a,value:i.btns[a],dialog_id:i.id,btn_target:n},l=null;for(var s in i.input)if(o[s]=this.active_dialog.find("[data-ax-dialog-prompt="+s+"]").val(),""==o[s]||null==o[s]){l=s;break}if(l)return!1;e&&e.call(o,a),this.close()}},this.close=function(){return this.active_dialog&&(this.active_dialog.remove(),this.active_dialog=null,axd(window).off("keydown.ax-dialog"),t.onclose&&t.onclose.call(this,this)),this}};e.isFunction(i)&&(n.prototype=new i),t.dialog=n}(ax5.ui,ax5.ui.root);