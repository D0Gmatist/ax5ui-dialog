!function(t,i){var e=ax5.util,a=function(){var t,a=this;this.main=function(){i&&i.call(this),this.config={clickEventName:"click",theme:"default",width:300,title:"",msg:"",lang:{ok:"ok",cancel:"cancel"}}}.apply(this,arguments),this.activeDialog=null,t=this.config,t.id="ax5-dialog-"+ax5.getGuid(),this.init=function(){},this.alert=function(i,o){return e.isString(i)&&(i={title:t.title,msg:i}),this.activeDialog?(console.log(ax5.info.getError("ax5dialog","501","alert")),this):(a.dialogConfig={},jQuery.extend(!0,a.dialogConfig,t),jQuery.extend(!0,a.dialogConfig,i),i=a.dialogConfig,i.dialogType="alert",i.theme=i.theme||t.theme||"","undefined"==typeof i.btns&&(i.btns={ok:{label:t.lang.ok,theme:i.theme}}),this.open(i,o),this)},this.confirm=function(i,o){return e.isString(i)&&(i={title:t.title,msg:i}),this.activeDialog?(console.log(ax5.info.getError("ax5dialog","501","confirm")),this):(a.dialogConfig={},jQuery.extend(!0,a.dialogConfig,t),jQuery.extend(!0,a.dialogConfig,i),i=a.dialogConfig,i.dialogType="confirm",i.theme=i.theme||t.theme||"","undefined"==typeof i.btns&&(i.btns={ok:{label:t.lang.ok,theme:i.theme},cancel:{label:t.lang.cancel}}),this.open(i,o),this)},this.prompt=function(i,o){return e.isString(i)&&(i={title:t.title,msg:i}),this.activeDialog?(console.log(ax5.info.getError("ax5dialog","501","prompt")),this):(a.dialogConfig={},jQuery.extend(!0,a.dialogConfig,t),jQuery.extend(!0,a.dialogConfig,i),i=a.dialogConfig,i.dialogType="prompt",i.theme=i.theme||t.theme||"","undefined"==typeof i.input&&(i.input={value:{label:i.msg||t.msg||""}}),"undefined"==typeof i.btns&&(i.btns={ok:{label:t.lang.ok,theme:i.theme},cancel:{label:t.lang.cancel}}),this.open(i,o),this)},this.getContent=function(i,a){var o=[];return o.push('<div id="'+i+'" data-ax5-ui="dialog" class="ax5-ui-dialog '+a.theme+'">'),o.push('<div class="ax-dialog-heading">'),o.push(a.title||t.title||""),o.push("</div>"),o.push('<div class="ax-dialog-body">'),o.push('<div class="ax-dialog-msg">'),o.push((a.msg||t.msg||"").replace(/\n/g,"<br/>")),o.push("</div>"),a.input&&(o.push('<div class="ax-dialog-prompt">'),e.each(a.input,function(t,i){o.push('<div class="form-group">'),o.push("    <label>"+this.label.replace(/\n/g,"<br/>")+"</label>"),o.push('    <input type="'+(this.type||"text")+'" placeholder="'+(this.placeholder||"")+' " class="form-control '+(this.theme||"")+'" data-ax-dialog-prompt="'+t+'" style="width:100%;" value="'+(this.value||"")+'" />'),this.help&&o.push('    <p class="help-block">'+this.help.replace(/\n/g,"<br/>")+"</p>"),o.push("</div>")}),o.push("</div>")),o.push('<div class="ax-dialog-buttons">'),o.push('<div class="ax-button-wrap">'),e.each(a.btns,function(t,i){o.push('<button type="button" data-ax-dialog-btn="'+t+'" class="btn btn-'+(this.theme||"default")+'">'+this.label+"</button>")}),o.push("</div>"),o.push("</div>"),o.push("</div>"),o.push("</div>"),o.join("")},this.open=function(i,e){var a,o={};if(i.id=i.id||t.id,box={width:i.width||t.width},jQuery(document.body).append(this.getContent(i.id,i)),this.activeDialog=jQuery("#"+i.id),this.activeDialog.css({width:box.width}),box.height=this.activeDialog.height(),"undefined"==typeof i.position||"center"===i.position){var n=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,l=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;o.top=l/2-box.height/2,o.left=n/2-box.width/2}else o.left=i.position.left||0,o.top=i.position.top||0;return this.activeDialog.css(o),"prompt"===i.dialogType?this.activeDialog.find("[data-ax-dialog-prompt]").get(0).focus():this.activeDialog.find("[data-ax-dialog-btn]").get(0).focus(),this.activeDialog.find("[data-ax-dialog-btn]").on(t.clickEventName,function(t){this.btnOnclick(t||window.event,i,e)}.bind(this)),jQuery(window).bind("keydown.ax-dialog",function(t){this.onkeyup(t||window.event,i,e)}.bind(this)),i&&i.onStateChanged&&(a={state:"open"},i.onStateChanged.call(a,a)),this},this.btnOnclick=function(t,i,a,o,n){if(t.srcElement&&(t.target=t.srcElement),o=e.findParentNode(t.target,function(t){return t.getAttribute("data-ax-dialog-btn")?!0:void 0})){n=o.getAttribute("data-ax-dialog-btn");var l={key:n,value:i.btns[n],dialogId:i.id,btnTarget:o};if("prompt"===i.dialogType){var s=null;for(var d in i.input)if(l[d]=this.activeDialog.find("[data-ax-dialog-prompt="+d+"]").val(),""==l[d]||null==l[d]){s=d;break}}if(i.btns[n].onclick)i.btns[n].onclick.call(l,n);else if("alert"===i.dialogType)a&&a.call(l,n),this.close();else if("confirm"===i.dialogType)a&&a.call(l,n),this.close();else if("prompt"===i.dialogType){if("ok"===n&&s)return this.activeDialog.find('[data-ax-dialog-prompt="'+s+'"]').get(0).focus(),!1;a&&a.call(l,n),this.close()}}},this.onkeyup=function(t,i,e,a,o){if(t.keyCode==ax5.info.eventKeys.ESC&&this.close(),"prompt"===i.dialogType&&t.keyCode==ax5.info.eventKeys.RETURN){var n={key:o,value:i.btns[o],dialogId:i.id,btnTarget:a},l=null;for(var s in i.input)if(n[s]=this.activeDialog.find("[data-ax-dialog-prompt="+s+"]").val(),""==n[s]||null==n[s]){l=s;break}if(l)return!1;e&&e.call(n,o),this.close()}},this.close=function(){var t={},i=a.dialogConfig;return this.activeDialog&&(this.activeDialog.remove(),this.activeDialog=null,jQuery(window).unbind("keydown.ax-dialog"),i&&i.onStateChanged&&(t={state:"close"},i.onStateChanged.call(t,t))),this}};e.isFunction(i)&&(a.prototype=new i),t.dialog=a}(ax5.ui,ax5.ui.root);